<!DOCTYPE html>
<html><head><meta charset="UTF-8"><title>Clinical MatchMaker</title>
<script type="module">
import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
mermaid.initialize({startOnLoad:true,theme:'default'});
window.addEventListener('load', () => {
    const moduleData = {"schemas_TypeScript": {"filename": "schemas_TypeScript.prompt", "priority": 1, "description": "TypeScript module with Zod schemas for PatientProfile, TrialDiscovery, EligibilityCriteria, MatchResult, and VoiceScript. Provides parse functions and type inference. Used by all agents and components for data validation at boundaries.", "dependencies": [], "tags": ["shared", "validation", "types"], "filepath": "lib/schemas.ts"}, "config_TypeScript": {"filename": "config_TypeScript.prompt", "priority": 2, "description": "TypeScript module exporting validated environment configuration. Loads TOOLHOUSE_API_KEY, RTRVR_API_KEY, ELEVENLABS_API_KEY, STRIPE_PUBLISHABLE_KEY from environment. Provides getConfig() function with Zod validation for required keys.", "dependencies": ["schemas_TypeScript.prompt"], "tags": ["config", "environment"], "filepath": "lib/config.ts"}, "toolhouse_client_TypeScript": {"filename": "toolhouse_client_TypeScript.prompt", "priority": 3, "description": "TypeScript client wrapping Toolhouse SDK. Initializes connection, provides runAgent() method for executing agents with tool bundles. Handles agent-to-agent communication and pipeline state. Supports Anthropic Claude as LLM provider.", "dependencies": ["config_TypeScript.prompt", "schemas_TypeScript.prompt"], "tags": ["client", "agent", "orchestration"], "filepath": "lib/toolhouse.ts"}, "rtrvr_client_TypeScript": {"filename": "rtrvr_client_TypeScript.prompt", "priority": 4, "description": "TypeScript client for rtrvr.ai API. Provides scrape() method for extracting structured data from ClinicalTrials.gov trial pages. Uses /agent endpoint for full automation with schema-guided extraction.", "dependencies": ["config_TypeScript.prompt", "schemas_TypeScript.prompt"], "tags": ["client", "scraping", "extraction"], "filepath": "lib/rtrvr.ts"}, "elevenlabs_client_TypeScript": {"filename": "elevenlabs_client_TypeScript.prompt", "priority": 5, "description": "TypeScript client wrapping ElevenLabs API. Provides synthesize() method converting text to audio. Supports multiple voices and languages. Returns audio URL and duration. Uses Flash v2.5 for low latency.", "dependencies": ["config_TypeScript.prompt"], "tags": ["client", "voice", "tts"], "filepath": "lib/elevenlabs.ts"}, "stripe_client_TypeScript": {"filename": "stripe_client_TypeScript.prompt", "priority": 6, "description": "TypeScript module wrapping Stripe.js for client-only Checkout. Provides createCheckoutSession() for additional trial matches purchase. Uses Stripe Payment Links for serverless payment flow.", "dependencies": ["config_TypeScript.prompt"], "tags": ["client", "payments", "monetization"], "filepath": "lib/stripe.ts"}, "geo_utils_TypeScript": {"filename": "geo_utils_TypeScript.prompt", "priority": 7, "description": "TypeScript module for location-based filtering. Provides getCoordinates() to convert zipcode to lat/lng, calculateDistance() using Haversine formula, and filterByRadius() to filter trials within travel distance.", "dependencies": [], "tags": ["utility", "location", "distance"], "filepath": "lib/geo-utils.ts"}, "agent_scout_TypeScript": {"filename": "agent_scout_TypeScript.prompt", "priority": 8, "description": "Clinical Trial Scout agent using Toolhouse orchestration. Queries ClinicalTrials.gov API v2.0 for recruiting interventional trials. Filters by condition, location, and phase. Returns up to 5 trial candidates with basic metadata. Uses rtrvr.ai for additional data extraction if needed.", "dependencies": ["toolhouse_client_TypeScript.prompt", "rtrvr_client_TypeScript.prompt", "schemas_TypeScript.prompt", "geo_utils_TypeScript.prompt"], "tags": ["agent", "discovery", "clinicaltrials"], "filepath": "agents/scout/index.ts"}, "agent_extractor_TypeScript": {"filename": "agent_extractor_TypeScript.prompt", "priority": 9, "description": "Eligibility Extractor agent using rtrvr.ai for web extraction. Parses inclusion/exclusion criteria from ClinicalTrials.gov trial pages. Categorizes criteria by type (diagnosis, biomarker, treatment, other). Returns structured eligibility JSON.", "dependencies": ["toolhouse_client_TypeScript.prompt", "rtrvr_client_TypeScript.prompt", "schemas_TypeScript.prompt"], "tags": ["agent", "extraction", "eligibility"], "filepath": "agents/extractor/index.ts"}, "agent_matcher_TypeScript": {"filename": "agent_matcher_TypeScript.prompt", "priority": 10, "description": "Clinical Matching Specialist agent. Compares patient profile fields against extracted eligibility criteria. Evaluates hard exclusions first, then inclusion alignment. Calculates weighted score (0-100) with category assignment (strong_match/possible_match/future_potential/not_eligible). Generates factor breakdown and plain-language summary.", "dependencies": ["toolhouse_client_TypeScript.prompt", "schemas_TypeScript.prompt"], "tags": ["agent", "matching", "scoring"], "filepath": "agents/matcher/index.ts"}, "agent_advocate_TypeScript": {"filename": "agent_advocate_TypeScript.prompt", "priority": 11, "description": "Patient Advocate agent. Takes match results and generates plain-language voice script (8th-grade reading level). Includes encouraging tone, clear next steps, doctor consultation reminder, and required disclaimer. Synthesizes audio via ElevenLabs API. Supports multiple languages.", "dependencies": ["toolhouse_client_TypeScript.prompt", "elevenlabs_client_TypeScript.prompt", "schemas_TypeScript.prompt"], "tags": ["agent", "voice", "advocacy"], "filepath": "agents/advocate/index.ts"}, "orchestrator_TypeScript": {"filename": "orchestrator_TypeScript.prompt", "priority": 12, "description": "Main orchestrator module coordinating the multi-agent pipeline. Executes: Scout -> Extractor (parallel per trial) -> Matcher (parallel per trial) -> Advocate. Manages pipeline state, handles errors with graceful degradation, implements retry logic, and tracks execution progress for UI updates.", "dependencies": ["agent_scout_TypeScript.prompt", "agent_extractor_TypeScript.prompt", "agent_matcher_TypeScript.prompt", "agent_advocate_TypeScript.prompt", "schemas_TypeScript.prompt"], "tags": ["orchestration", "pipeline", "coordination"], "filepath": "lib/orchestrator.ts"}, "intake_form_component_TypeScriptReact": {"filename": "intake_form_component_TypeScriptReact.prompt", "priority": 13, "description": "React component for patient data entry. Fields: diagnosis (text), stage (dropdown), biomarkers (text), ECOG score (0-4 dropdown), previous treatments (multi-select), zipcode (text), travel radius (slider), language preference (dropdown). Uses react-hook-form with Zod validation. Submits to orchestrator.", "dependencies": ["schemas_TypeScript.prompt"], "tags": ["frontend", "component", "form"], "filepath": "src/components/IntakeForm.tsx"}, "trial_card_component_TypeScriptReact": {"filename": "trial_card_component_TypeScriptReact.prompt", "priority": 14, "description": "React component rendering single trial match card. Shows trial title, NCT ID, phase, sponsor, match score badge (color-coded by category), matching/blocking/uncertain factors list, nearest location with distance, and 'Learn More' link to clinicaltrials.gov.", "dependencies": ["schemas_TypeScript.prompt"], "tags": ["frontend", "component", "ui"], "filepath": "src/components/TrialCard.tsx"}, "match_pie_chart_component_TypeScriptReact": {"filename": "match_pie_chart_component_TypeScriptReact.prompt", "priority": 15, "description": "React component using Recharts to display pie chart of match categories. Shows distribution of strong_match, possible_match, future_potential, and not_eligible. Color-coded segments with legend and counts.", "dependencies": ["schemas_TypeScript.prompt"], "tags": ["frontend", "component", "visualization"], "filepath": "src/components/MatchPieChart.tsx"}, "audio_player_component_TypeScriptReact": {"filename": "audio_player_component_TypeScriptReact.prompt", "priority": 16, "description": "React component for playing ElevenLabs-generated audio. Shows play/pause button, progress bar, duration display. Includes transcript toggle for accessibility (hearing impaired). Displays voice script text when expanded.", "dependencies": ["schemas_TypeScript.prompt"], "tags": ["frontend", "component", "accessibility", "audio"], "filepath": "src/components/AudioPlayer.tsx"}, "progress_indicator_component_TypeScriptReact": {"filename": "progress_indicator_component_TypeScriptReact.prompt", "priority": 17, "description": "React component displaying multi-step progress during pipeline execution. Shows 4 agent steps with status indicators (pending/running/complete/error). Displays current agent name, elapsed time, and optional log messages. Animated transitions between steps.", "dependencies": ["schemas_TypeScript.prompt"], "tags": ["frontend", "component", "ui", "status"], "filepath": "src/components/ProgressIndicator.tsx"}, "payment_modal_component_TypeScriptReact": {"filename": "payment_modal_component_TypeScriptReact.prompt", "priority": 18, "description": "React component displaying upgrade prompt and Stripe checkout integration. Shows remaining free matches count, pricing info, and 'Upgrade' button. Uses Stripe Payment Links for serverless checkout flow. Handles success/cancel callbacks.", "dependencies": ["stripe_client_TypeScript.prompt"], "tags": ["frontend", "component", "payments"], "filepath": "src/components/PaymentModal.tsx"}, "disclaimer_banner_component_TypeScriptReact": {"filename": "disclaimer_banner_component_TypeScriptReact.prompt", "priority": 19, "description": "React component rendering required medical disclaimer text. Styled as persistent banner at bottom of screen. Text: 'This tool provides informational guidance only and does not constitute medical advice. Always consult with a qualified healthcare provider before making decisions about clinical trial participation.'", "dependencies": [], "tags": ["frontend", "component", "compliance"], "filepath": "src/components/DisclaimerBanner.tsx"}, "landing_page_TypeScriptReact": {"filename": "landing_page_TypeScriptReact.prompt", "priority": 20, "description": "React page component for landing route (/). Displays hero section with value proposition, problem statement, how-it-works steps, and CTA button linking to intake form. Mobile-responsive layout with Tailwind styling.", "dependencies": ["disclaimer_banner_component_TypeScriptReact.prompt"], "tags": ["frontend", "page"], "filepath": "src/pages/Landing.tsx"}, "intake_page_TypeScriptReact": {"filename": "intake_page_TypeScriptReact.prompt", "priority": 21, "description": "React page component for intake route (/intake). Renders IntakeForm component. On submit, stores patient profile in session state and navigates to processing page. Includes back link to landing.", "dependencies": ["intake_form_component_TypeScriptReact.prompt", "disclaimer_banner_component_TypeScriptReact.prompt", "schemas_TypeScript.prompt"], "tags": ["frontend", "page"], "filepath": "src/pages/Intake.tsx"}, "processing_page_TypeScriptReact": {"filename": "processing_page_TypeScriptReact.prompt", "priority": 22, "description": "React page component for processing route (/processing). Executes orchestrator pipeline on mount. Displays ProgressIndicator with real-time status updates. On completion, navigates to results page with data. Handles errors with retry option.", "dependencies": ["progress_indicator_component_TypeScriptReact.prompt", "orchestrator_TypeScript.prompt", "disclaimer_banner_component_TypeScriptReact.prompt"], "tags": ["frontend", "page"], "filepath": "src/pages/Processing.tsx"}, "results_page_TypeScriptReact": {"filename": "results_page_TypeScriptReact.prompt", "priority": 23, "description": "React page component for results route (/results). Displays MatchPieChart, sorted TrialCard list, AudioPlayer with voice summary. Includes 'Start Over' button to reset and return to landing. Shows disclaimer banner.", "dependencies": ["trial_card_component_TypeScriptReact.prompt", "match_pie_chart_component_TypeScriptReact.prompt", "audio_player_component_TypeScriptReact.prompt", "payment_modal_component_TypeScriptReact.prompt", "disclaimer_banner_component_TypeScriptReact.prompt", "schemas_TypeScript.prompt"], "tags": ["frontend", "page"], "filepath": "src/pages/Results.tsx"}, "app_root_TypeScriptReact": {"filename": "app_root_TypeScriptReact.prompt", "priority": 24, "description": "React root component with React Router configuration. Defines routes for /, /intake, /processing, /results. Wraps app in session context provider for sharing pipeline data between pages. Includes global error boundary.", "dependencies": ["landing_page_TypeScriptReact.prompt", "intake_page_TypeScriptReact.prompt", "processing_page_TypeScriptReact.prompt", "results_page_TypeScriptReact.prompt"], "tags": ["frontend", "root", "routing"], "filepath": "src/App.tsx"}, "main_entry_TypeScriptReact": {"filename": "main_entry_TypeScriptReact.prompt", "priority": 25, "description": "Application entry point. Imports global CSS, initializes React 18 with createRoot, renders App component. Sets up strict mode for development.", "dependencies": ["app_root_TypeScriptReact.prompt"], "tags": ["frontend", "entry"], "filepath": "src/main.tsx"}};
    
    // Add hover listeners to all nodes
    setTimeout(() => {
        const nodes = document.querySelectorAll('.node');
        nodes.forEach(node => {
            const text = node.querySelector('.nodeLabel');
            if (!text) return;
            
            const nodeText = text.textContent.trim();
            const moduleId = nodeText.split(' ')[0];
            const data = moduleData[moduleId];
            
            if (data) {
                node.style.cursor = 'pointer';
                
                node.addEventListener('mouseenter', (e) => {
                    showTooltip(e, data);
                });
                
                node.addEventListener('mouseleave', () => {
                    hideTooltip();
                });
            }
        });
    }, 500);
});
function showTooltip(e, data) {
    hideTooltip();
    
    const tooltip = document.createElement('div');
    tooltip.id = 'module-tooltip';
    tooltip.innerHTML = `
        <div style="font-weight:600;margin-bottom:8px;font-size:1.1em;">${data.filename}</div>
        <div style="margin-bottom:6px;"><strong>Priority:</strong> ${data.priority}</div>
        <div style="margin-bottom:6px;"><strong>Path:</strong> ${data.filepath}</div>
        <div style="margin-bottom:6px;"><strong>Tags:</strong> ${data.tags.join(', ')}</div>
        <div style="margin-bottom:6px;"><strong>Dependencies:</strong> ${data.dependencies.length > 0 ? data.dependencies.join(', ') : 'None'}</div>
        <div style="margin-top:8px;padding-top:8px;border-top:1px solid #ddd;font-size:0.9em;color:#444;">${data.description}</div>
    `;
    
    document.body.appendChild(tooltip);
    
    const rect = e.target.closest('.node').getBoundingClientRect();
    tooltip.style.left = rect.right + 10 + 'px';
    tooltip.style.top = rect.top + window.scrollY + 'px';
}
function hideTooltip() {
    const existing = document.getElementById('module-tooltip');
    if (existing) existing.remove();
}
</script>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:system-ui,sans-serif;background:#fff;color:#000;padding:2rem;max-width:1400px;margin:0 auto}
h1{font-size:2rem;font-weight:600;margin-bottom:2rem;padding-bottom:1rem;border-bottom:2px solid #000}
.diagram{border:1px solid #000;padding:2rem;margin:2rem 0;overflow-x:auto;position:relative}
.mermaid{display:flex;justify-content:center}
#module-tooltip{
    position:absolute;
    background:#fff;
    border:2px solid #000;
    padding:1rem;
    max-width:400px;
    z-index:1000;
    box-shadow:4px 4px 0 rgba(0,0,0,0.1);
    font-size:0.9rem;
    line-height:1.5;
}
.node{transition:opacity 0.2s}
.node:hover{opacity:0.8}
</style></head><body>
<h1>Clinical MatchMaker</h1>
<div class="diagram"><pre class="mermaid">flowchart TB
        PRD["Clinical MatchMaker"]
    
    subgraph Frontend
        intake_form_component_TypeScriptReact["intake_form_component_TypeScriptReact (13)"]
        trial_card_component_TypeScriptReact["trial_card_component_TypeScriptReact (14)"]
        match_pie_chart_component_TypeScriptReact["match_pie_chart_component_TypeScriptReact (15)"]
        audio_player_component_TypeScriptReact["audio_player_component_TypeScriptReact (16)"]
        progress_indicator_component_TypeScriptReact["progress_indicator_component_TypeScriptReact (17)"]
        payment_modal_component_TypeScriptReact["payment_modal_component_TypeScriptReact (18)"]
        disclaimer_banner_component_TypeScriptReact["disclaimer_banner_component_TypeScriptReact (19)"]
        landing_page_TypeScriptReact["landing_page_TypeScriptReact (20)"]
        intake_page_TypeScriptReact["intake_page_TypeScriptReact (21)"]
        processing_page_TypeScriptReact["processing_page_TypeScriptReact (22)"]
        results_page_TypeScriptReact["results_page_TypeScriptReact (23)"]
        app_root_TypeScriptReact["app_root_TypeScriptReact (24)"]
        main_entry_TypeScriptReact["main_entry_TypeScriptReact (25)"]
    end
    
    subgraph Shared
        schemas_TypeScript["schemas_TypeScript (1)"]
        config_TypeScript["config_TypeScript (2)"]
        toolhouse_client_TypeScript["toolhouse_client_TypeScript (3)"]
        rtrvr_client_TypeScript["rtrvr_client_TypeScript (4)"]
        elevenlabs_client_TypeScript["elevenlabs_client_TypeScript (5)"]
        stripe_client_TypeScript["stripe_client_TypeScript (6)"]
        geo_utils_TypeScript["geo_utils_TypeScript (7)"]
        agent_scout_TypeScript["agent_scout_TypeScript (8)"]
        agent_extractor_TypeScript["agent_extractor_TypeScript (9)"]
        agent_matcher_TypeScript["agent_matcher_TypeScript (10)"]
        agent_advocate_TypeScript["agent_advocate_TypeScript (11)"]
        orchestrator_TypeScript["orchestrator_TypeScript (12)"]
    end
    
    PRD --> Frontend

    config_TypeScript -->|uses| schemas_TypeScript
    toolhouse_client_TypeScript -->|uses| config_TypeScript
    toolhouse_client_TypeScript -->|uses| schemas_TypeScript
    rtrvr_client_TypeScript -->|uses| config_TypeScript
    rtrvr_client_TypeScript -->|uses| schemas_TypeScript
    elevenlabs_client_TypeScript -->|uses| config_TypeScript
    stripe_client_TypeScript -->|uses| config_TypeScript
    agent_scout_TypeScript -->|uses| toolhouse_client_TypeScript
    agent_scout_TypeScript -->|uses| rtrvr_client_TypeScript
    agent_scout_TypeScript -->|uses| schemas_TypeScript
    agent_scout_TypeScript -->|uses| geo_utils_TypeScript
    agent_extractor_TypeScript -->|uses| toolhouse_client_TypeScript
    agent_extractor_TypeScript -->|uses| rtrvr_client_TypeScript
    agent_extractor_TypeScript -->|uses| schemas_TypeScript
    agent_matcher_TypeScript -->|uses| toolhouse_client_TypeScript
    agent_matcher_TypeScript -->|uses| schemas_TypeScript
    agent_advocate_TypeScript -->|uses| toolhouse_client_TypeScript
    agent_advocate_TypeScript -->|uses| elevenlabs_client_TypeScript
    agent_advocate_TypeScript -->|uses| schemas_TypeScript
    orchestrator_TypeScript -->|uses| agent_scout_TypeScript
    orchestrator_TypeScript -->|uses| agent_extractor_TypeScript
    orchestrator_TypeScript -->|uses| agent_matcher_TypeScript
    orchestrator_TypeScript -->|uses| agent_advocate_TypeScript
    orchestrator_TypeScript -->|uses| schemas_TypeScript
    intake_form_component_TypeScriptReact -->|uses| schemas_TypeScript
    trial_card_component_TypeScriptReact -->|uses| schemas_TypeScript
    match_pie_chart_component_TypeScriptReact -->|uses| schemas_TypeScript
    audio_player_component_TypeScriptReact -->|uses| schemas_TypeScript
    progress_indicator_component_TypeScriptReact -->|uses| schemas_TypeScript
    payment_modal_component_TypeScriptReact -->|uses| stripe_client_TypeScript
    landing_page_TypeScriptReact -->|uses| disclaimer_banner_component_TypeScriptReact
    intake_page_TypeScriptReact -->|uses| intake_form_component_TypeScriptReact
    intake_page_TypeScriptReact -->|uses| disclaimer_banner_component_TypeScriptReact
    intake_page_TypeScriptReact -->|uses| schemas_TypeScript
    processing_page_TypeScriptReact -->|uses| progress_indicator_component_TypeScriptReact
    processing_page_TypeScriptReact -->|uses| orchestrator_TypeScript
    processing_page_TypeScriptReact -->|uses| disclaimer_banner_component_TypeScriptReact
    results_page_TypeScriptReact -->|uses| trial_card_component_TypeScriptReact
    results_page_TypeScriptReact -->|uses| match_pie_chart_component_TypeScriptReact
    results_page_TypeScriptReact -->|uses| audio_player_component_TypeScriptReact
    results_page_TypeScriptReact -->|uses| payment_modal_component_TypeScriptReact
    results_page_TypeScriptReact -->|uses| disclaimer_banner_component_TypeScriptReact
    results_page_TypeScriptReact -->|uses| schemas_TypeScript
    app_root_TypeScriptReact -->|uses| landing_page_TypeScriptReact
    app_root_TypeScriptReact -->|uses| intake_page_TypeScriptReact
    app_root_TypeScriptReact -->|uses| processing_page_TypeScriptReact
    app_root_TypeScriptReact -->|uses| results_page_TypeScriptReact
    main_entry_TypeScriptReact -->|uses| app_root_TypeScriptReact
    
    classDef frontend fill:#FFF3E0,stroke:#F57C00,stroke-width:2px
    classDef backend fill:#E3F2FD,stroke:#1976D2,stroke-width:2px
    classDef shared fill:#E8F5E9,stroke:#388E3C,stroke-width:2px
    classDef system fill:#E0E0E0,stroke:#616161,stroke-width:3px
    
    class intake_form_component_TypeScriptReact,trial_card_component_TypeScriptReact,match_pie_chart_component_TypeScriptReact,audio_player_component_TypeScriptReact,progress_indicator_component_TypeScriptReact,payment_modal_component_TypeScriptReact,disclaimer_banner_component_TypeScriptReact,landing_page_TypeScriptReact,intake_page_TypeScriptReact,processing_page_TypeScriptReact,results_page_TypeScriptReact,app_root_TypeScriptReact,main_entry_TypeScriptReact frontend
    class schemas_TypeScript,config_TypeScript,toolhouse_client_TypeScript,rtrvr_client_TypeScript,elevenlabs_client_TypeScript,stripe_client_TypeScript,geo_utils_TypeScript,agent_scout_TypeScript,agent_extractor_TypeScript,agent_matcher_TypeScript,agent_advocate_TypeScript,orchestrator_TypeScript shared
    class PRD system</pre></div>
</body></html>